const tickers = require('./tickerToName.json');
const names = require('./nameToTicker.json');

const lookup = input => {
  const ticker = input.toUpperCase();
  return tickers.hasOwnProperty(ticker) ? tickers[ticker].name : null;
};

const search = input => {
  const tickerResults = searchTicker(input);
  const nameResults = searchName(input);

  return [...new Set([...tickerResults, ...nameResults])];
};

const searchTicker = input => {
  const keys = Object.keys(tickers);
  const search = input.toUpperCase();
  let results = [];
  let hits = [];
  for (let i = 0; i < keys.length; i++) {
    if (keys[i].indexOf(search) !== -1) {
      hits.push(tickers[keys[i]].ticker);
      results.push(tickers[keys[i]]);
    }
    if (results.length > 5) {
      return results;
    }
  }
  return results;
};

const searchName = input => {
  const keys = Object.keys(names);
  const search = input.toLowerCase();
  let results = [];
  for (let i = 0; i < keys.length; i++) {
    if (keys[i].indexOf(search) !== -1) {
      results.push(names[keys[i]]);
    }
    if (results.length > 5) {
      return results;
    }
  }
  return results;
};

module.exports = { lookup, search, searchTicker, searchName };
